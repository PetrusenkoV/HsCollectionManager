@model HsCollectionManager.Models.SelectCards

@{
    ViewBag.Title = "AllCards";
}
<link href="~/Content/HideButtons.css" rel="stylesheet" />
<h2>AllCards</h2>

@foreach (var item in Model.Cards.Take(4))
{
    <div style="float: left; width: 280px;">
        <h3 style="text-align: center">@item.Name</h3>
        <img src="@item.Img" />
        <button class="@(@Model.UserModel.IsEditable ? "1" : "hidden")">Add</button>
        <button class="@(@Model.UserModel.IsEditable ? "2 visible" : "hidden")">Remove</button>
    </div>
}
@foreach (var item in Model.Cards.Skip(4).Take(4))
{
    <div style="float: left; width: 280px;">
        <h3 style="text-align: center">@item.Name</h3>
        <img src="@item.Img" />
        <button class="@(@Model.UserModel.IsEditable ? "1" : "hidden")">Add</button>
        <button class="@(@Model.UserModel.IsEditable ? "2 visible" : "hidden")">Remove</button>
    </div>
}
<div style="clear: left; margin: 20px">

    @Html.ActionLink("Prev", "ShowCardsManaCost", "Home", new { UserName = Model.UserModel.UserName, UserId = Model.UserModel.UserId, manacost = Model.UserModel.Manacost,
    Model.UserModel.IsEditable,page = @Model.PageInfo.CurrentPage - 1 }, new { @style = "clear: left", @class = Model.PageInfo.CurrentPage == 1 ? "btn btn-success hidden" : "btn btn-success" })
    
    @Html.ActionLink("All", "ShowCards", "Home", new { userName = Model.UserModel.UserName, userId = Model.UserModel.UserId, Model.UserModel.IsEditable, page = 1 }, new { @style = "clear: left", @class = "btn btn-warning" })
    @Html.ActionLink("0", "ShowCards", "Home", new { userId = Model.UserModel.UserId, userName = Model.UserModel.UserName, manacost = 0, Model.UserModel.IsEditable }, new { @class = "btn btn-warning" })
    @Html.ActionLink("1", "ShowCards", "Home", new { userId = Model.UserModel.UserId, userName = Model.UserModel.UserName, manacost = 1, Model.UserModel.IsEditable }, new { @class = "btn btn-warning" })
    @Html.ActionLink("2", "ShowCards", "Home", new { userId = Model.UserModel.UserId, userName = Model.UserModel.UserName, manacost = 2, Model.UserModel.IsEditable }, new { @class = "btn btn-warning" })
    @Html.ActionLink("3", "ShowCards", "Home", new { userId = Model.UserModel.UserId, userName = Model.UserModel.UserName, manacost = 3, Model.UserModel.IsEditable }, new { @class = "btn btn-warning" })
    @Html.ActionLink("4", "ShowCards", "Home", new { userId = Model.UserModel.UserId, userName = Model.UserModel.UserName, manacost = 4, Model.UserModel.IsEditable }, new { @class = "btn btn-warning" })
    @Html.ActionLink("5", "ShowCards", "Home", new { userId = Model.UserModel.UserId, userName = Model.UserModel.UserName, manacost = 5, Model.UserModel.IsEditable }, new { @class = "btn btn-warning" })
    @Html.ActionLink("6", "ShowCards", "Home", new { userId = Model.UserModel.UserId, userName = Model.UserModel.UserName, manacost = 6, Model.UserModel.IsEditable }, new { @class = "btn btn-warning" })
    @Html.ActionLink("7+", "ShowUserCardsMoreThenSevenManaCost", "Home", new { userId = Model.UserModel.UserId, userName = Model.UserModel.UserName }, new { @class = "btn btn-warning" })

    @Html.ActionLink("Next", "ShowCardsManaCost", "Home", new { UserName = Model.UserModel.UserName, UserId = Model.UserModel.UserId, manacost = Model.UserModel.Manacost,
    Model.UserModel.IsEditable, page = @Model.PageInfo.CurrentPage + 1 }, new { @style = "clear: left", @class = Model.PageInfo.CurrentPage == Model.PageInfo.TotalPages ? "btn btn-success hidden" : "btn btn-success" })



    @Html.ActionLink("Finish", "ShowCards", new { userName = Model.UserModel.UserName, userId = Model.UserModel.UserId, isEditable = false, page = 1 }, new { @class = Model.UserModel.IsEditable ? "btn btn-success" : "hidden" })
</div>
<script>
    var addToCollection = function () {
        var img = this.parentElement.getElementsByTagName('img');

        $.ajax({
            type: "POST",
            url: "/Home/InsertUserCard",
            content: "application/json; charset=utf-8",
            dataType: "json",
            data: { CardImg: img[0].src, UserId: "@Model.UserModel.UserId" },
            success: function () {
            },
            error: function (xhr, textStatus, errorThrown) {
                // TODO: Show error
            }
        });

        var btns = this.parentElement.getElementsByTagName('button');
        for (var i = 0; i < btns.length; i++) {
            btns[i].classList.toggle("visible");
        }
    }

    var removeFromCollection = function () {
        var img = this.parentElement.getElementsByTagName('img');

        $.ajax({
            type: "POST",
            url: "/Home/RemoveFromCollection",
            content: "application/json; charset=utf-8",
            dataType: "json",
            data: { CardImg: img[0].src, UserId: "@Model.UserModel.UserId" },
            success: function () {
            },
            error: function (xhr, textStatus, errorThrown) {
                // TODO: Show error
            }
        });

        var btns = this.parentElement.getElementsByTagName('button');
        for (var i = 0; i < btns.length; i++) {
            btns[i].classList.toggle("visible");
        }
    }

    var btns1 = document.getElementsByClassName('1');
    for (var i = 0; i < btns1.length; i++) {
        btns1[i].addEventListener("click", addToCollection);
    }

    var btns2 = document.getElementsByClassName('2');
    for (var i = 0; i < btns2.length; i++) {
        btns2[i].addEventListener("click", removeFromCollection);
    }
</script>








